PENDIENTES DE INTEGRACI√ìN (WIP)

Autenticaci√≥n y seguridad
- Reemplazar stubs de verify-password.php y verify-sms.php por validaci√≥n real (hash Argon2id en BD y proveedor SMS/2FA).
- Mover secretos/credenciales a config/.env.local.php (no versionado) y ajustar loaders.
- CSRF tokens para endpoints POST/DELETE y CORS restringido a dominio.

Consultorios (persistencia)
- Definir esquema MySQL para consultorios (1..3 por m√©dico) y grupos m√©dicos; crear migraciones.
- Endpoints CRUD: crear/actualizar/eliminar consultorio (incluye horarios, tel√©fonos, WhatsApp y coordenadas).
- Subida de foto: endpoint seguro, validaci√≥n MIME/tama√±o, storage con nombres aleatorios y registro en BD.

Mapas/Geocoding
- Consolidar uso de Leaflet + Nominatim con manejo de errores y l√≠mites; cache local de resultados.
- Permitir manual override de lat/lng y guardar en BD.

Grupos m√©dicos (sugerencias)
- Endpoint de suggest groups por CP/colonia/calle/tel√©fono; modal de consentimiento y v√≠nculo en BD.
- Desvinculaci√≥n/edici√≥n de grupo por consultorio.

UI/UX
- Bot√≥n ‚ÄúEliminar consultorio‚Äù con server-side verification y logs.
- M√°scaras/normalizadores de tel√©fonos por pa√≠s y formato.
- Validaciones accesibles (ARIA, roles) y mensajes consistentes.

Infraestructura
- Registrar logs de auditor√≠a (acciones CRUD, IP, user_id) y rotaci√≥n de logs.
- Tests b√°sicos para endpoints (PHP) y comportamientos cr√≠ticos (JS).

Grupos mÈdicos ó integraciÛn completa
- Backend (BD + API):
  - Tablas: groups (id, nombre, slug, domicilio_normalizado, logo_url, created_at, updated_at) y group_members (group_id, consultorio_id, joined_at, joined_by).
  - NormalizaciÛn server-side de direcciÛn/telÈfonos; Ìndices por CP/Colonia/Municipio/Estado; b˙squeda fuzzy opcional por nombre/calle.
  - Endpoints: GET /api/groups/suggest (cp, colonia, mun, edo, calle, num, tel) ? [{id,nombre,addr,score,logo_url}]; POST /api/groups/join {consultorio_id, group_id}; POST /api/groups/leave {consultorio_id}; GET /api/groups/:id/logo (CDN + cache headers).
  - Privacidad: no exponer PII de usuarios; registrar consentimiento (timestamp, user_id, ip, snapshot de datos) en auditorÌa.
- Frontend:
  - Sustituir stub JS por consumo real de suggest (debounce + manejo de errores) y mostrar modal de confirmaciÛn.
  - Al aceptar: POST /groups/join; reflejar radio ìSÌî, nombre del grupo; bloquear dropzone de logo con toggle ìUsar logo del grupoî.
  - En ìCambiarî o cambio de direcciÛn: POST /groups/leave; reactivar dropzone.
  - Multi-consultorios: extender lÛgica a sede 2/3 (IDs con sufijos; asociaciÛn independiente por sede).
  - Rate-limit y ìno sugerir de nuevoî por dataset; reset al cambiar campos clave.
- Seguridad y calidad:
  - Permisos: solo admins del grupo pueden cambiar logo; miembros lo heredan por defecto.
  - Logs/auditorÌa de joins/leaves y rechazos de sugerencia.
  - Tests unitarios (PHP) y e2e (front) para suggest/join/leave y flujo de modal.
